---
name: punchlisting-report
description: "金地深圳地区公司，项目交付前维修和销项阶段，将项目线下用于统计各参建单位销项、返单数据和进展的excel表格，进行读取、理解，并在此基础上进行统计，输出包含图表、文字的项目维修日报。"
license: Proprietary. LICENSE.txt has complete terms
---

# 项目维修整改日报生成系统

## 技能概述

本技能用于自动化生成项目交付前的维修整改日报。系统读取包含各参建单位销项、返单数据的 Excel 表格,进行数据统计分析,并输出包含图表和文字描述的专业日报文档,为公司领导层提供项目整改进度的决策支持。

## 功能说明

### 核心功能
1. **数据读取与解析**:使用 `xlsx` 技能读取 Excel 数据表
2. **数据统计分析**:计算关键指标(销项率、返单率、完成率等)
3. **报告生成**:使用 `docx` 技能生成结构化的 Word 日报文档
4. **可视化呈现**:生成柱状图、折线图等图表展示数据趋势

### 报告内容模块
- **本日整改销项情况**:当日返单情况、复验合格率、销项率统计
- **总体及各施工单位销项情况**:累计数据分析、重点单位追踪
- **各楼栋销项销户情况**:分楼栋完成度统计
- **数据分析与点评**:问题识别、进度预警、改进建议

## 输入数据格式

### Excel 表格结构要求

**必需列**:
- `序号`: 施工单位序号
- `责任单位`: 施工单位名称
- `工种分类`: 工种/工作类别
- `责任人(项目经理)`: 负责人信息
- `本日返单情况`: 是否返单(是/否/无问题返单)
- `本日工种全部销项率`: 当日完成率(%)
- `本日返单量`: 当日返单数量
- `本日复验销项合格量`: 当日合格数量
- `本日复验销项合格率(销项合格量/本日返单量)`: 合格率(%)
- `本日新增问题`: 新增问题数
- `累计工人数量`: 整改人数
- `今日销项数量`: 今日完成数
- `累计新增问题`: 累计问题总数
- `累计完成销项量(12项/日期数)`: 累计完成量
- `实体完成率`: 实际完成率(%)
- `累计完成销项量`: 累计完成总量
- `累计全部问题量`: 累计问题总量
- `累计全部完成销项量`: 累计完成总量
- `累计全部完成销项率`: 累计完成率(%)
- `日均销项量(12项/日期数)`: 日均完成量
- `总体完成率`: 总体完成率(%)

**可选列**:
- `楼栋号`: 所属楼栋(用于楼栋统计)
- `备注`: 额外说明信息

## 输出报告格式

### Word 文档结构

#### 1. 标题与说明
```
[项目名称]项目[楼栋范围]查验整改日报

各位领导、同事:
自[开始日期]以来,保修办持续开展新一轮查验,现将每日整改销项情况汇报如下:
```

#### 2. 一、本日整改销项情况

**2.1 数据概要**

**(1) 本日返单情况**
- 统计室内销项责任单位总数
- 列出本日返单单位数量和未返单单位名称
- 标注一直未返单的单位(连续多日未返单)

示例格式:
```
本日返单情况(是否返单): 室内销项责任单位共计 22 个。本日返单 10 个,
本日未返单 12 个单位为: IJF、珠江、科勒、大金、日立、百朗、史密斯、博世、
新奥燃气、浩先、海德、优谷; 一直未返单单位: 珠江、大金、史密斯、博世、
新奥燃气、浩先、优谷。
```

**图表需求**: 柱状图 - 按单位本日返单量排序

**(2) 本日复验销项合格率**
- 本日施工单位返单总量
- 本日返单率(返单量/总问题量)
- 保修工程师本日复核销项合格量
- 本日复验销项合格率(合格量/返单量)
- 列出复验合格率过低的单位(<60%为非常低,60-80%为低)

示例格式:
```
本日复验销项合格率: 本日施工单位返单量为 681 条,本日返单率为 7.58%,
保修工程师本日复核销项合格量为 263 条,本日复验销项合格率为 38.62%,

其中,泰和精装泥水、泰和精装水电、泰和美容、中伟精装泥水、中伟精装水电、
中伟精装油漆、中伟精装不锈钢、中伟美缝,共 8 家单位工种复验销项合格率
非常低(<60%)。王力安防调试,共 1 家单位工种复验销项合格率低(60%-80%)。
```

**图表需求**: 柱状图 - 按单位本日复验销项合格率排序

**(3) 本日销项率**
- 计算本日销项率 = 本日复验销项合格量 / 总体问题量

**图表需求**: 对比柱状图 - 按单位应完成销项率 vs 实际销项率

#### 3. 二、总体及各施工单位销项情况

**3.1 数据概要**

**(1) 总体销项情况**
- 启动日期
- 总查验问题累计数
- 新增问题数
- 销项已完成数
- 未销项数
- 日均销项量
- 总体销项率(已完成/总问题)
- 整改工人数
- 每日人均销项量(日均销项量/工人数)

示例格式:
```
总体销项情况: 自 2025 年 12 月 2 日启动预验收整改工作以来,总查验问题累计 
8989 条,新增问题 100 条; 销项已完成 2318 条,未销项 6671 条,日均销项量 
289.8 条,总体销项率为 25.79%。整改工人数 137 人,每日人均销项量 2.1 条。
```

**图表需求**: 综合数据展示图

**(2) 各施工单位销项情况**

**A. 累计问题量(前五)施工单位销项情况**
- 列出累计问题量最多的前5个单位
- 每个单位的累计问题数和销项完成率

示例格式:
```
累计问题量(前五)施工单位销项情况: 截止目前,22 个施工单位中,
中伟 2680 条,销项完成率 28.69%; IJF 2096 条,销项完成率 24.00%; 
和海枫 1133 条,销项完成率 4.24%; 泰和 1112 条,销项完成率 23.56%; 
珠江 465 条,销项完成率 0.00%。
```

**图表需求**:
- 对比柱状图: 各单位总体应完成销项率 vs 实际完成销项率
- 折线图: 重点单位每日实际完成销项率趋势(需要历史数据)

**重点单位定义**: 群安达、中伟、泰和、IJF、珠江、和海枫、华为

**B. 销项率较低(倒数前10)施工单位销项情况**
- 列出销项率最低的前10个单位及其销项率

示例格式:
```
销项率较低(倒数前10)施工单位销项情况: 珠江 0.00%,史密斯 0.00%,
浩先 0.00%,优谷 0.00%,和海枫 4.24%,东辉 10.62%,泰和 23.56%,
IJF 24.00%,中伟 28.69%,群安达 37.30%。
```

**图表需求**: 柱状图 - 展示最低10个单位的销项率

**3.2 数据分析与点评**

分析要点:
1. 总体销项率评估(是否低于预期)
2. 整改人力资源分析(人数是否充足)
3. 按当前速率推算剩余整改天数
4. 计算达成目标截止日期所需的日均销项量
5. 识别问题突出的单位

示例格式:
```
1) 截止本日,总体销项率 25.79% 较低,整改工人 137 人数量极少。即使按照
现有查验问题累计数量,以目前的日均销项速率推演,整改需要再持续 23.0 天,
将无法达成以 12 月 20 日为整改关门的节点。

2) 以 12 月 20 日为整改关门节点,剩余整改时限为 11 天,日均销项量应不低于 
606.5 条。

3) 累计未完成问题量为前 5 单位 中伟、IJF、和海枫、泰和、珠江,销项率较低
的单位有 珠江、史密斯、浩先、优谷、和海枫、东辉、泰和、IJF、中伟、群安达。
```

#### 4. 三、各楼栋总体销项、销户情况

**4.1 数据概要**
- 项目规划总户数
- 存在待整改问题的户数
- 户均问题率(总问题量/待整改户数)
- 总体销户率(已完成户数/总户数)
- 各楼栋销户情况明细

示例格式:
```
本项目规划户数为 520 户,存在待整改问题户数为 318 户,户均问题率为 
28.31 条,总体销户率为 2.52%。各楼栋销户情况为: 1栋 0.00%、2栋 0.00%、
3栋 0.00%、4栋 0.00%、5栋 12.31%、6栋 0.00%、7栋 0.00%、8栋 0.00%、
9栋 0.00%。
```

**4.2 数据分析与点评**

分析要点:
1. 销户率低的原因分析
2. 劳动力投入不足的单位
3. 未启动整改的单位

示例格式:
```
由于部分施工单位尚未启动整改工作,且各施工单位未投入充足劳动力进行整改,
导致日均销项率较低,总体完成率较低,从而导致销户率趋近于 2.52%。
```

## 数据计算规则

### 关键指标计算公式

1. **本日返单率** = 本日返单量 / 累计全部问题量 × 100%

2. **本日复验销项合格率** = 本日复验销项合格量 / 本日返单量 × 100%

3. **本日销项率** = 本日复验销项合格量 / 累计全部问题量 × 100%

4. **总体销项率** = 累计完成销项量 / 累计全部问题量 × 100%

5. **日均销项量** = 累计完成销项量 / 已工作天数

6. **每日人均销项量** = 日均销项量 / 整改工人总数

7. **户均问题率** = 累计全部问题量 / 待整改问题户数

8. **总体销户率** = 已完成户数 / 项目规划总户数 × 100%

9. **预计剩余天数** = 未销项问题量 / 日均销项量

10. **目标日均销项量** = 未销项问题量 / 剩余整改天数

### 分类标准

**复验合格率等级**:
- 非常低: < 60%
- 低: 60% - 80%
- 正常: 80% - 95%
- 优秀: ≥ 95%

**返单状态分类**:
- 本日返单: 当日有返单记录
- 本日未返单: 当日无返单记录
- 一直未返单: 连续3日及以上未返单

## 使用方法

### 基本用法

```bash
# 生成日报
claude code run punchlisting-report --input [Excel文件路径] --output [输出Word文件路径]

# 指定日期
claude code run punchlisting-report --input data.xlsx --output report.docx --date 2025-01-12

# 指定目标截止日期
claude code run punchlisting-report --input data.xlsx --output report.docx --deadline 2025-12-20
```

### 参数说明

- `--input`: 输入的 Excel 数据文件路径(必需)
- `--output`: 输出的 Word 报告文件路径(可选,默认为"日报_YYYYMMDD.docx")
- `--date`: 报告日期(可选,默认为当前日期)
- `--deadline`: 整改目标截止日期(可选,默认为当前日期后20天)
- `--project-name`: 项目名称(可选,默认从数据中提取)
- `--building-range`: 楼栋范围(可选,如"1-9号楼")
- `--start-date`: 整改启动日期(可选,用于计算已工作天数)

## 数据验证

系统会自动验证输入数据的完整性和合理性:

- ✅ 检查必需列是否存在
- ✅ 验证数值字段是否为有效数字
- ✅ 检查百分比数值是否在合理范围(0-100%)
- ✅ 识别空值和异常值
- ✅ 验证单位名称一致性
- ⚠️  对缺失或异常数据给出警告

## 输出文件特性

### Word 文档格式
- 标题: 黑体,小二号,加粗,居中
- 一级标题: 黑体,三号,加粗
- 二级标题: 黑体,小三号,加粗
- 三级标题: 黑体,四号,加粗
- 正文: 宋体,小四号
- 表格: 边框完整,标题行底纹填充
- 图表: 嵌入式,居中对齐,标注清晰

### 图表样式
- 柱状图: 蓝色系,显示数值标签
- 折线图: 多色区分,显示数据点
- 对比图: 双色对比,清晰标注

## 注意事项

1. **数据完整性**: 确保 Excel 文件包含所有必需列,列名需与规范一致
2. **数据格式**: 日期格式统一,百分比以小数或百分数形式表示
3. **单位命名**: 施工单位名称需保持一致,避免同一单位多种写法
4. **历史数据**: 如需生成趋势图,需提供历史日报数据或累计数据表
5. **文件权限**: 确保输出路径有写入权限
6. **Excel 版本**: 支持 .xlsx 格式(Excel 2007及以上版本)

## 技能依赖

- `xlsx`: 用于读取 Excel 文件
- `docx`: 用于生成 Word 文档
- Python 内置库: `datetime`, `collections`, `statistics`